---
- name: "Run functional test playbooks"
  hosts:  "{{ cifmw_target_hook_host | default('localhost') }}"
  tasks:
    - name: Search for stackrc file
      find:
        paths: "/"
        patterns: "stackrc"
      register: stackrc_files

    - debug:
        msg: "Found stackrc file at {{ item.path }}"
      loop: "{{ stackrc_files.files }}"

    - name: Test service API endpoint(metric) for autoscaling
      ansible.builtin.shell: |
        openstack endpoint list --service metric;
      register: result

    - name: Print the result
      ansible.builtin.debug:
        var: result