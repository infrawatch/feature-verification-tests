---
- name: "Verify logging journalctl identifiers"
  hosts: computes
  gather_facts: true
  ignore_errors: true
  environment:
    KUBECONFIG: "{{ cifmw_openshift_kubeconfig }}"
    PATH: "{{ cifmw_path }}"
  vars:
    telemetry_logging_journal_test_id: "RHOSO-12681"
    telemetry_logging_journal_list:
      - { name: ceilometer_agent_compute, test_id: "{{ telemetry_logging_journal_test_id }}" }
      - { name: nova_compute, test_id: "{{ telemetry_logging_journal_test_id }}" }

    common_file_test_id: "RHOSO-12754"
    common_file_list:
      - { name: "/etc/rsyslog.d/10-telemetry.conf", test_id: "{{ common_file_test_id }}"}
  tasks:
    - name: "Run Telemetry Logging tests"
      ansible.builtin.import_role:
        name: telemetry_logging

    - name: "Run the tests from the common role"
      ansible.builtin.import_role:
        name: common

- name: "Run container tests which require root on compute nodes"
  hosts: computes
  gather_facts: true
  become: true
  ignore_errors: true
  environment:
    KUBECONFIG: "{{ cifmw_openshift_kubeconfig }}"
    PATH: "{{ cifmw_path }}"
  vars:
    common_container_test_id: "RHOSO-12753"
    common_container_list:
      - ceilometer_agent_compute
      - node_exporter
  tasks:
    - name: "Run the tests from the common role"
      ansible.builtin.import_role:
        name: common
