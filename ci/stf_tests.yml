---
- name: "Run e2e tests"
  hosts: localhost
  ignore_errors: true
  gather_facts: false
  environment:
    KUBECONFIG: "/home/zuul/.crc/machines/crc/kubeconfig"
    PATH: "~/.crc/bin:~/.crc/bin/oc:~/bin:{{ ansible_env.PATH }}"
  tasks:
    - name: "Log into the cluster"
      ansible.builtin.import_role:
        name: rhol_crc
        tasks_from: add_crc_creds.yml
        
    - name: "try to run oc command"
      ansible.builtin.command:
        cmd:
          oc get csv --namespace=openshift-operators -l operators.coreos.com/cluster-observability-operator.openshift-operators
      register: output
