---
- name: "Run e2e tests"
  hosts: localhost
  ignore_errors: true
  gather_facts: true
  environment:
    PATH: "~/.crc/bin:~/.crc/bin/oc:~/bin:{{ ansible_env.PATH }}"
    KUBECONFIG: "{{ ansible_env.HOME }}/.crc/machines/crc/kubeconfig"
  tasks:
    - name: "Log into the cluster"
      ansible.builtin.import_role:
        name: rhol_crc
        tasks_from: add_crc_creds.yml

    - name: "Run collectd Prometheus queries"
      ansible.builtin.import_role:
        name: client_side_tests