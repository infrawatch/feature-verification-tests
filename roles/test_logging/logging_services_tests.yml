---

- name: Verify "{{ item }}" Service Running in "{{ nspace }}"
  ansible.builtin.shell:
    cmd: |
      oc get service -n "{{ nspace }}" "{{ item }}"
  register: output 
  changed_when: false
  ignore_errors: yes

- name: If "{{ item }}" service exists
  set_fact:
    exists: PASSED 
  when: output.rc == 0

- name: If  "{{ item }}" service does *not* exist
  set_fact:
     exists: FAILED
  when: output.rc != 0

- name: Push service check results to "{{ services_out_file }}"
  ansible.builtin.shell:
    echo "Service,{{ item }},{{ exists }}" >> "{{ services_out_file }}"
  changed_when: false
