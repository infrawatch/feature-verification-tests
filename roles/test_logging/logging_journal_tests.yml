---

- name: Get journals
  ansible.builtin.shell:
    cmd:
      journalctl -t "{{ item }}" --no-pager | wc -l
  register: journal_wc
  changed_when: false
  failed_when: false

- name: Set status "{{ item }}"
  ansible.builtin.set_fact:
    t_status: FAILED      

- name: Set file status to PASSED - "{{ item }}"
  ansible.builtin.set_fact:
    t_status: PASSED
  when: 
    - journal_wc.rc == 0
    - journal_wc.stdout | int >= 0
  failed_when: false

- name: Push result to "{{ journal_exists_outfile }}"
  ansible.builtin.lineinfile:
    path: "{{ journal_exists_outfile }}"
    line: "{{ item }},{{ journal_wc.stdout }},{{ t_status }}"
    state: present
    create: yes
  changed_when: false
